(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{236:function(e,t,n){e.exports=n(426)},241:function(e,t,n){},247:function(e,t){},249:function(e,t){},424:function(e,t,n){},426:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(48),o=n.n(c),i=n(99),u=n(42),l=(n(241),n(437)),s=n(29),m=n.n(s),f=n(49),p=n(440),d=n(202),v=n.n(d),h=n(132),w=function(e){var t=e.id,n=e.accessToken,a=e.accessTokenSecret,r="https://w4b8r4621c.execute-api.ap-northeast-2.amazonaws.com/dev",c="id=".concat(t,"&access_token_key=").concat(n,"&access_token_secret=").concat(a);"".concat(r,"/show?").concat(c);return"".concat(r,"/show?").concat(c)};function E(e){return e.extended_entities.media.map(function(e){var t="video"===e.type?e.video_info.variants[0].url:e.media_url_https;return{id:e.id_str,type:e.type,url:t}})}var b=/^\d+$/,g=/\/.+\/status\/(\d+)/,k=/twitter\.com\/.+\/status\/(\d+)/;var y=function(e){var t=e.split(".").pop()||"";return(t=t.split("?")[0])&&(t=t.replace(":orig","")),t||""},x=function(e){return"".concat(e,".json")},S=function(e){return JSON.stringify(e,null,2)},j=function(e){var t=e.tweet,n=t.id_str;return a.createElement(p.a,{onClick:function(){var e=new Blob([S(t)]);h.saveAs(e,x(n))}},"tweet json")},I=function(e){var t=e.tweet,n=t.id_str,r=function(){var e=Object(f.a)(m.a.mark(function e(){var a,r,c,o,i,u,l,s,f,p,d;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(a=new v.a).file(x(n),S(t)),r=E(t),c=r.map(function(e){return e.url}),e.next=6,Promise.all(c.map(function(e){return fetch(e)}));case 6:for(o=e.sent,i=0;i<o.length;i++)u=c[i],l=o[i],s=l.blob(),f=y(u),p="".concat(n,"_").concat(i+1,".").concat(f),a.file(p,s,{binary:!0});return e.next=10,a.generateAsync({type:"blob"});case 10:d=e.sent,h.saveAs(d,"".concat(n,".zip"));case 12:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();return a.createElement(p.a,{onClick:r},"zip (tweet json + media)")},O=function(e){var t=e.tweet;return a.createElement("div",null,a.createElement(j,{tweet:t}),a.createElement(I,{tweet:t}))},_=n(41),A=n(439),C=n(66),z=n(43),L=n.n(z),P="twitter-access-token",T="twitter-secret",U=function(){var e=Object(a.useState)(L.a.auth().currentUser),t=Object(_.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)(null),i=Object(_.a)(o,2),u=i[0],l=i[1];function s(){return p.apply(this,arguments)}function p(){return(p=Object(f.a)(m.a.mark(function e(){var t,n,a;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,L.a.auth().setPersistence(L.a.auth.Auth.Persistence.LOCAL);case 3:return t=new L.a.auth.TwitterAuthProvider,e.next=6,L.a.auth().signInWithPopup(t);case 6:n=e.sent,c(n.user),a=n.credential,localStorage.setItem(P,a.accessToken),localStorage.setItem(T,a.secret),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(0),console.error(e.t0),l(e.t0);case 17:case"end":return e.stop()}},e,null,[[0,13]])}))).apply(this,arguments)}function d(){return v.apply(this,arguments)}function v(){return(v=Object(f.a)(m.a.mark(function e(){return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return localStorage.removeItem(P),localStorage.removeItem(T),e.next=4,L.a.auth().signOut();case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}return L.a.auth().onAuthStateChanged(function(e){c(e)}),r.a.createElement(A.a,null,r.a.createElement(A.a.Item,null,r.a.createElement("a",{href:"/serina"},"serina")),u?r.a.createElement(A.a.Item,null,"Error!"):n?r.a.createElement(r.a.Fragment,null,r.a.createElement(A.a.Item,null,r.a.createElement("img",{src:n.photoURL,alt:n.displayName}),r.a.createElement("span",null,n.displayName)),r.a.createElement(A.a.Item,{onClick:d},r.a.createElement(C.a,{name:"sign out"}),"Sign Out")):r.a.createElement(A.a.Item,{name:"sign in",onClick:s},"Sign In"))},R=n(438),B=function(e){var t=e.initialId,n=e.history,c=Object(a.useState)(t||""),o=Object(_.a)(c,2),u=o[0],l=o[1],s=function(e){var t=e.trim();if(b.test(t))return t;try{var n=new URL(t);if(!n.host.endsWith("twitter.com"))return;var a=g.exec(n.pathname);return a?a[1]:void 0}catch(c){}var r=k.exec(t);return r?r[1]:void 0}(u),m="".concat(G,"?id=").concat(s);return r.a.createElement(R.a,{onSubmit:function(e,t){e.preventDefault(),n.push(m)}},r.a.createElement(R.a.Field,{error:void 0===s},r.a.createElement("label",null,"tweet id"),r.a.createElement("input",{type:"text",name:"query",placeholder:"898755978153181185",value:u,onChange:function(e){l(e.target.value)}})),r.a.createElement(R.a.Field,null,r.a.createElement(p.a,{as:i.b,to:m},"fetch")))},N=n(222),W=n.n(N),D=n(223),F=function(e){var t=e.id,n=localStorage.getItem(P),c=localStorage.getItem(T),o=Object(a.useState)(null),i=Object(_.a)(o,2),u=i[0],l=i[1],s=Object(a.useState)(!1),p=Object(_.a)(s,2),d=p[0],v=p[1];function h(){return(h=Object(f.a)(m.a.mark(function e(t){var a,r,o,i;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:if(c){e.next=4;break}return e.abrupt("return");case 4:return v(!0),e.prev=5,a=w({id:t,accessToken:n,accessTokenSecret:c}),e.next=9,fetch(a);case 9:if(!((r=e.sent).status>=400)){e.next=15;break}return e.next=13,r.json();case 13:throw o=e.sent,new Error(o.message);case 15:return e.next=17,r.json();case 17:i=e.sent,l(i),e.next=24;break;case 21:e.prev=21,e.t0=e.catch(5),l(e.t0);case 24:v(!1);case 25:case"end":return e.stop()}},e,null,[[5,21]])}))).apply(this,arguments)}if(r.a.useEffect(function(){!function(e){h.apply(this,arguments)}(t)},[t]),!n)return r.a.createElement("div",null,"access token not found");if(!c)return r.a.createElement("div",null,"secret token not found");var E=function(e,t){if(t)return q({});if(W.a.isError(e))return $({error:e});if(e)return J({tweet:e});return q({})}(u,d);return r.a.createElement("div",null,E,r.a.createElement("h3",null,"preview"),r.a.createElement(D.a,{id:t}))};var J=function(e){var t=e.tweet,n=E(t);return r.a.createElement("div",null,r.a.createElement("h3",null,"download"),r.a.createElement(O,{tweet:t}),r.a.createElement("h3",null,"media list"),r.a.createElement("ol",null,n.map(function(e){return r.a.createElement("li",{key:e.id},r.a.createElement("a",{href:e.url,target:"_blank",rel:"noopener noreferrer"},e.type," ",e.id))})))},$=function(e){var t=e.error,n=t?t.toString():"blank";return r.a.createElement("div",null,"error : ",n)},q=function(){return r.a.createElement("div",null,"running")},G=(n(423),n(424),"/serina/"),K=function(e){var t=new URLSearchParams(window.location.search).get("id");return r.a.createElement(l.a,{text:!0},r.a.createElement(U,null),r.a.createElement(B,{initialId:t,history:e.history}),t?r.a.createElement(F,{id:t}):null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Q=n(224);n(425);Q.initializeApp({apiKey:"AIzaSyA6uzrv7S9DuRkgyswaAiE1NmGasCUkezQ",authDomain:"serina-dfa02.firebaseapp.com",databaseURL:"https://serina-dfa02.firebaseio.com",projectId:"serina-dfa02",storageBucket:"",messagingSenderId:"705473550769",appId:"1:705473550769:web:374d2e571c3115aa"});o.a.render(r.a.createElement(function(){return r.a.createElement(i.a,null,r.a.createElement(u.a,{component:K}))},null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[236,1,2]]]);
//# sourceMappingURL=main.0466516f.chunk.js.map